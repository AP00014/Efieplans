import{j as e,X as A,M as Ke,S as Ue,L as Ye,F as Z,B as ye,a as We,U as xe,b as Fe,H as He,c as Je,d as Xe,e as Qe,C as we,E as Ze,f as de,g as O,h as Ce,T as Se,i as Ee,k as je,I as le,l as ze,m as Te,n as Ie,R as Le,P as K,W as Me,o as De,p as _e,V as ne,q as Pe}from"./ui-vendor-CGRqESeM.js";import{r,j as es}from"./react-vendor-CgVTdkFV.js";import{R as ss,s as g}from"./index-El7sF2ch.js";import"./supabase-vendor-DXEREdEf.js";const gs=()=>{const[a,x]=r.useState("dashboard"),[T,y]=r.useState(!1),[h,w]=r.useState(null),[I,P]=r.useState(!0),b=es(),{isDarkMode:C,toggleTheme:E}=ss(),z=async()=>{await g.auth.signOut(),b("/")};r.useEffect(()=>{(async()=>{const{data:{user:U}}=await g.auth.getUser();if(!U){b("/");return}const{data:D}=await g.from("profiles").select("id, username, role, created_at, updated_at").eq("id",U.id).single();if(!D||D.role!=="admin"){b("/");return}w(D),P(!1)})()},[b]);const t=[{id:"dashboard",label:"Dashboard",icon:Ye},{id:"create-post",label:"Create Post",icon:Z},{id:"posts",label:"Post Management",icon:Z},{id:"create-project",label:"Create Project",icon:ye},{id:"manage-projects",label:"Manage Projects",icon:We},{id:"users",label:"User Management",icon:xe},{id:"contact-messages",label:"Contacts",icon:Z},{id:"email-subscriptions",label:"Subscriptions",icon:xe},{id:"send-newsletter",label:"Send Newsletter",icon:Fe},{id:"home",label:"Homepage",icon:He},{id:"blogpage",label:"Blogpage",icon:Z}],j=()=>{switch(a){case"dashboard":return e.jsx(ke,{});case"create-post":return e.jsx(as,{});case"posts":return e.jsx(is,{});case"create-project":return e.jsx(cs,{});case"manage-projects":return e.jsx(ds,{});case"users":return e.jsx(ts,{});case"contact-messages":return e.jsx(ns,{});case"email-subscriptions":return e.jsx(os,{});case"send-newsletter":return e.jsx(rs,{});default:return e.jsx(ke,{})}};return I?e.jsxs("div",{className:"admin-loading",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Verifying admin access..."})]}):e.jsxs("div",{className:"admin-page",children:[e.jsx("button",{className:"mobile-menu-btn",onClick:()=>y(!T),children:T?e.jsx(A,{size:24}):e.jsx(Ke,{size:24})}),e.jsxs("aside",{className:`admin-sidebar ${T?"open":""} ${C?"dark":""}`,children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsx(Ue,{size:32,className:"admin-icon"}),e.jsx("h2",{children:"Admin Panel"})]}),e.jsx("nav",{className:"sidebar-nav",children:t.map(i=>{const U=i.icon;return e.jsxs("button",{className:`nav-item ${a===i.id?"active":""}`,onClick:()=>{i.id==="home"?b("/"):i.id==="blogpage"?b("/blog"):x(i.id),y(!1)},children:[e.jsx(U,{size:20}),e.jsx("span",{children:i.label})]},i.id)})}),e.jsxs("div",{className:"sidebar-footer",children:[e.jsxs("p",{children:["Logged in as: ",h?.username]}),e.jsxs("div",{className:"sidebar-controls",children:[e.jsx("button",{className:"theme-toggle-btn",onClick:E,title:C?"Switch to Light Mode":"Switch to Dark Mode",style:{background:C?"rgba(255, 255, 255, 0.1)":"rgba(255, 255, 255, 0.9)",border:C?"1px solid rgba(255, 255, 255, 0.2)":"1px solid rgba(0, 123, 255, 0.2)",color:C?"#FFFFFF":"#4a5568"},children:C?e.jsx(Je,{size:16}):e.jsx(Xe,{size:16})}),e.jsxs("button",{className:"logout-btn",onClick:z,children:[e.jsx(Qe,{size:16}),"Logout"]})]})]})]}),e.jsx("main",{className:"admin-main",children:e.jsx("div",{className:"admin-content",children:j()})})]})},as=()=>{const[a,x]=r.useState({title:"",content:"",images:[],videos:[],tags:[],category:""}),[T,y]=r.useState(""),[h,w]=r.useState(""),[I,P]=r.useState(""),[b,C]=r.useState(!1),E=u=>{const{name:f,value:k}=u.target;x(d=>({...d,[f]:k}))},z=()=>{T.trim()&&!a.tags.includes(T.trim())&&(x(u=>({...u,tags:[...u.tags,T.trim()]})),y(""))},t=u=>{x(f=>({...f,tags:f.tags.filter(k=>k!==u)}))},j=()=>{h.trim()&&a.images.length<4?(x(u=>({...u,images:[...u.images,h.trim()]})),w("")):a.images.length>=4&&alert("Maximum 4 images allowed")},i=()=>{I.trim()&&(x(u=>({...u,videos:[...u.videos||[],I.trim()]})),P(""))},U=(u,f)=>{const k=f==="image"?["image/jpeg","image/jpg","image/png","image/gif","image/webp"]:["video/mp4","video/avi","video/mov","video/wmv","video/webm"];return k.includes(u.type)?!0:(alert(`Please select a valid ${f} file (${k.join(", ")})`),!1)},D=async(u,f)=>{const{data:{user:k}}=await g.auth.getUser();if(!k)throw new Error("You must be logged in to upload files");const d=u.name.split(".").pop(),v=`${Date.now()}-${Math.random().toString(36).substring(2)}.${d}`,p=`posts/${f}s/${v}`,{error:F}=await g.storage.from("storage").upload(p,u);if(F)throw F;const{data:_}=g.storage.from("storage").getPublicUrl(p);return _.publicUrl},V=async(u,f)=>{const{data:{user:k}}=await g.auth.getUser();if(!k){alert("You must be logged in to upload files");return}const d=Array.from(u);for(const p of d)if(U(p,f))try{const F=await D(p,f);f==="image"?a.images.length<4?x(_=>({..._,images:[..._.images,F]})):alert("Maximum 4 images allowed"):x(_=>({..._,videos:[..._.videos||[],F]}))}catch{alert(`Failed to upload ${p.name}. Please try again or contact support if the issue persists.`)}const v=document.getElementById(f==="image"?"image-upload":"video-upload");v&&(v.value="")},B=async u=>{u.preventDefault(),C(!0);try{const{data:{user:f}}=await g.auth.getUser();if(!f)throw new Error("Not authenticated");const{error:k}=await g.from("posts").insert({user_id:f.id,title:a.title,content:a.content,image_url:a.images.length>0?JSON.stringify(a.images):null,video_url:a.videos.length>0?JSON.stringify(a.videos):null,tags:a.tags,category:a.category});if(k)throw k;alert("Post created successfully!"),x({title:"",content:"",images:[],videos:[],tags:[],category:""}),w(""),P("")}catch{alert("Failed to create post")}finally{C(!1)}};return e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Create New Post"}),e.jsx("p",{children:"Share your thoughts and media with the community"})]}),e.jsxs("form",{onSubmit:B,className:"create-post-form",children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"title",children:"Post Title"}),e.jsx("input",{type:"text",id:"title",name:"title",value:a.title,onChange:E,placeholder:"Enter an engaging title...",required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"content",children:"Content"}),e.jsx("textarea",{id:"content",name:"content",value:a.content,onChange:E,placeholder:"Write your post content here...",required:!0,rows:8,className:"form-textarea"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"category",children:"Category"}),e.jsxs("select",{id:"category",name:"category",value:a.category,onChange:u=>x(f=>({...f,category:u.target.value})),required:!0,className:"form-input",children:[e.jsx("option",{value:"",children:"Select a category"}),e.jsx("option",{value:"architectural design",children:"Architectural Design"}),e.jsx("option",{value:"construction",children:"Construction"}),e.jsx("option",{value:"interior design",children:"Interior Design"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tags"}),e.jsxs("div",{className:"tag-input-group",children:[e.jsx("input",{type:"text",value:T,onChange:u=>y(u.target.value),placeholder:"Add a tag...",className:"form-input",onKeyDown:u=>u.key==="Enter"&&(u.preventDefault(),z())}),e.jsxs("button",{type:"button",onClick:z,className:"add-tag-btn",children:[e.jsx(K,{size:16}),"Add"]})]}),e.jsx("div",{className:"tags-display",children:a.tags.map((u,f)=>e.jsxs("span",{className:"tag",children:[e.jsx(je,{size:12}),u,e.jsx("button",{type:"button",onClick:()=>t(u),className:"remove-tag",children:e.jsx(A,{size:12})})]},f))})]})]}),e.jsx("div",{className:"form-section",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Media Upload"}),e.jsxs("div",{className:"media-upload-section",children:[e.jsxs("div",{className:"upload-group",children:[e.jsxs("label",{className:"upload-label",children:[e.jsx(le,{size:20}),"Images (",a.images.length,"/4)"]}),e.jsxs("div",{className:"url-input-group",children:[e.jsx("input",{type:"url",value:h,onChange:u=>w(u.target.value),placeholder:"Enter image URL...",className:"form-input",onKeyDown:u=>u.key==="Enter"&&(u.preventDefault(),j())}),e.jsx("button",{type:"button",onClick:j,className:"add-url-btn",children:"Add Image"})]}),e.jsxs("div",{className:"url-input-group",children:[e.jsxs("label",{htmlFor:"image-upload",style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",width:"100%"},children:[e.jsx(O,{size:16}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:u=>u.target.files&&V(u.target.files,"image"),className:"form-input",id:"image-upload",style:{padding:"0.5rem",flex:1}})]}),e.jsx("span",{style:{fontSize:"0.875rem",color:"#666",marginTop:"0.25rem"},children:"Max 4 images, unlimited file size"})]}),a.images.map((u,f)=>e.jsxs("div",{className:"media-preview",children:[e.jsx("img",{src:u,alt:`Preview ${f+1}`,className:"preview-image",onError:k=>{k.currentTarget.style.display="none",k.currentTarget.nextElementSibling?.classList.add("error")},onLoad:k=>{k.currentTarget.style.display="block"}}),e.jsx("div",{className:"image-error",style:{display:"none"},children:"Failed to load image"}),e.jsx("button",{type:"button",onClick:()=>{x(d=>({...d,images:d.images.filter((v,p)=>p!==f)}));const k=document.getElementById("image-upload");k&&(k.value="")},className:"remove-media",title:"Remove image",children:e.jsx(A,{size:16})})]},f))]}),e.jsxs("div",{className:"upload-group",children:[e.jsxs("label",{className:"upload-label",children:[e.jsx(ne,{size:20}),"Video"]}),e.jsxs("div",{className:"url-input-group",children:[e.jsx("input",{type:"url",value:I,onChange:u=>P(u.target.value),placeholder:"Enter video URL...",className:"form-input",onKeyDown:u=>u.key==="Enter"&&(u.preventDefault(),i())}),e.jsx("button",{type:"button",onClick:i,className:"add-url-btn",children:"Add Video"})]}),e.jsxs("div",{className:"url-input-group",children:[e.jsxs("label",{htmlFor:"video-upload",style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",width:"100%"},children:[e.jsx(O,{size:16}),e.jsx("input",{type:"file",accept:"video/*",onChange:u=>u.target.files&&V(u.target.files,"video"),className:"form-input",id:"video-upload",style:{padding:"0.5rem",flex:1}})]}),e.jsx("span",{style:{fontSize:"0.875rem",color:"#666",marginTop:"0.25rem"},children:"Unlimited file size"})]}),a.videos&&a.videos.length>0&&a.videos.map((u,f)=>e.jsxs("div",{className:"media-preview",children:[e.jsx("video",{src:u,className:"preview-video",controls:!0}),e.jsx("button",{type:"button",onClick:()=>{x(d=>({...d,videos:d.videos.filter((v,p)=>p!==f)}));const k=document.getElementById("video-upload");k&&(k.value="")},className:"remove-media",title:"Remove video",children:e.jsx(A,{size:16})})]},f))]})]})]})})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",className:"submit-btn",disabled:b,children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner small"}),"Creating Post..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:16}),"Create Post"]})})})]})]})},ke=()=>{const[a,x]=r.useState({totalUsers:0,totalAdmins:0,totalPosts:0,totalLikes:0,totalComments:0,recentUsers:[],recentPosts:[]}),[T,y]=r.useState(!0);return r.useEffect(()=>{(async()=>{try{const[w,I,P,b,C,E,z]=await Promise.all([g.from("profiles").select("*",{count:"exact",head:!0}),g.from("profiles").select("*",{count:"exact",head:!0}).eq("role","admin"),g.from("posts").select("*",{count:"exact",head:!0}),g.from("likes").select("*",{count:"exact",head:!0}),g.from("comments").select("*",{count:"exact",head:!0}),g.from("profiles").select("username, created_at").order("created_at",{ascending:!1}).limit(5),g.from("posts").select("title, created_at, user_id").order("created_at",{ascending:!1}).limit(5)]);x({totalUsers:w.count||0,totalAdmins:I.count||0,totalPosts:P.count||0,totalLikes:b.count||0,totalComments:C.count||0,recentUsers:E.data||[],recentPosts:z.data||[]})}catch{}finally{y(!1)}})()},[]),T?e.jsxs("div",{className:"content-section",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading dashboard..."})]}):e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Dashboard Overview"}),e.jsx("p",{children:"Monitor your platform's performance and user activity"})]}),e.jsxs("div",{className:"stats-grid",children:[e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon users",children:e.jsx(xe,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Total Users"}),e.jsx("p",{className:"stat-value",children:a.totalUsers})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon admins",children:e.jsx(Ue,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Administrators"}),e.jsx("p",{className:"stat-value",children:a.totalAdmins})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon posts",children:e.jsx(Z,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Total Posts"}),e.jsx("p",{className:"stat-value",children:a.totalPosts})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon likes",children:e.jsx(we,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Total Likes"}),e.jsx("p",{className:"stat-value",children:a.totalLikes})]})]}),e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:"stat-icon comments",children:e.jsx(we,{size:24})}),e.jsxs("div",{className:"stat-content",children:[e.jsx("h3",{children:"Total Comments"}),e.jsx("p",{className:"stat-value",children:a.totalComments})]})]})]}),e.jsxs("div",{className:"dashboard-grid",children:[e.jsxs("div",{className:"recent-activity",children:[e.jsx("h2",{children:"Recent Users"}),e.jsx("div",{className:"activity-list",children:a.recentUsers.map((h,w)=>e.jsxs("div",{className:"activity-item",children:[e.jsx("div",{className:"activity-icon",children:e.jsx(xe,{size:16})}),e.jsxs("div",{className:"activity-content",children:[e.jsxs("p",{children:[h.username," joined"]}),e.jsx("span",{children:new Date(h.created_at).toLocaleDateString()})]})]},w))})]}),e.jsxs("div",{className:"recent-activity",children:[e.jsx("h2",{children:"Recent Posts"}),e.jsx("div",{className:"activity-list",children:a.recentPosts.map((h,w)=>e.jsxs("div",{className:"activity-item",children:[e.jsx("div",{className:"activity-icon",children:e.jsx(Z,{size:16})}),e.jsxs("div",{className:"activity-content",children:[e.jsx("p",{children:h.title}),e.jsx("span",{children:new Date(h.created_at).toLocaleDateString()})]})]},w))})]})]})]})},ts=()=>{const[a,x]=r.useState([]),[T,y]=r.useState(!0),[h,w]=r.useState(""),[I,P]=r.useState(!1);r.useEffect(()=>{b()},[]);const b=async()=>{try{const{data:t,error:j}=await g.from("profiles").select("*").order("created_at",{ascending:!1});if(j)throw j;x(t||[])}catch{}finally{y(!1)}},C=async(t,j)=>{try{const{error:i}=await g.from("profiles").update({role:j}).eq("id",t);if(i)throw i;b()}catch{alert("Failed to update user role")}},E=async(t,j)=>{const i=j?"ban":"unban";if(window.confirm(`Are you sure you want to ${i} this user?`))try{const{error:D}=await g.from("profiles").update({is_banned:j,banned_at:j?new Date().toISOString():null,ban_reason:j?"Banned by admin":null}).eq("id",t);if(D)throw D;alert(`User ${i}ned successfully`),b(),x(V=>[...V])}catch{alert(`Failed to ${i} user`)}},z=a.filter(t=>t.username?.toLowerCase().includes(h.toLowerCase())||t.email?.toLowerCase().includes(h.toLowerCase())||t.full_name?.toLowerCase().includes(h.toLowerCase()));return T?e.jsxs("div",{className:"content-section",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading users..."})]}):e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"User Management"}),e.jsx("p",{children:"Manage user accounts and permissions"})]}),e.jsxs("div",{className:"management-controls",children:[e.jsxs("div",{className:"search-container",children:[e.jsx("button",{className:"search-toggle-btn",onClick:()=>P(!I),"aria-label":"Toggle search",children:e.jsx(de,{size:20})}),e.jsx("input",{type:"text",placeholder:"Search users by name, username, or email...",value:h,onChange:t=>w(t.target.value),className:`search-input ${I?"expanded":""}`}),h&&e.jsx("button",{className:"clear-search-btn",onClick:()=>w(""),"aria-label":"Clear search",children:e.jsx(A,{size:16})})]}),e.jsxs("div",{className:"stats-summary",children:[e.jsxs("span",{children:["Total Users: ",a.length]}),e.jsxs("span",{children:["Admins: ",a.filter(t=>t.role==="admin").length]})]})]}),e.jsx("div",{className:"data-table-container desktop-table",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Username"}),e.jsx("th",{children:"Full Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Role"}),e.jsx("th",{children:"Joined"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:z.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.username}),e.jsx("td",{children:t.full_name||"N/A"}),e.jsx("td",{children:t.email||"N/A"}),e.jsx("td",{children:e.jsxs("select",{value:t.role||"user",onChange:j=>C(t.id,j.target.value),className:"role-select",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})}),e.jsx("td",{children:new Date(t.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("button",{className:`action-btn ${t.is_banned?"unban":"ban"}`,onClick:()=>E(t.id,!t.is_banned),disabled:t.role==="admin",children:t.is_banned?"Unban":"Ban"})})]},t.id))})]})}),e.jsx("div",{className:"mobile-cards-view",children:z.map(t=>e.jsxs("div",{className:"user-card",children:[e.jsxs("div",{className:"user-card-header",children:[e.jsx("div",{className:"user-avatar-large",children:t.avatar_url?e.jsx("img",{src:t.avatar_url,alt:t.username}):e.jsx("div",{className:"default-avatar-large",children:"ðŸ‘¤"})}),e.jsxs("div",{className:"user-card-info",children:[e.jsx("h3",{className:"user-card-username",children:t.username}),e.jsx("p",{className:"user-card-name",children:t.full_name||"No full name"}),e.jsx("div",{className:"user-role-badge",children:e.jsx("span",{className:`role-badge ${t.role||"user"}`,children:t.role==="admin"?"Administrator":"User"})})]})]}),e.jsxs("div",{className:"user-card-details",children:[e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Email:"}),e.jsx("span",{className:"detail-value",children:t.email||"Not provided"})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Joined:"}),e.jsx("span",{className:"detail-value",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Status:"}),e.jsx("span",{className:`detail-value ${t.is_banned?"banned":"active"}`,children:t.is_banned?"Banned":"Active"})]}),e.jsxs("div",{className:"detail-item",children:[e.jsx("span",{className:"detail-label",children:"Bio:"}),e.jsx("span",{className:"detail-value",children:t.bio||"No bio available"})]})]}),e.jsxs("div",{className:"user-card-actions",children:[e.jsxs("div",{className:"role-selector-mobile",children:[e.jsx("label",{children:"Role:"}),e.jsxs("select",{value:t.role||"user",onChange:j=>C(t.id,j.target.value),className:"role-select-mobile",children:[e.jsx("option",{value:"user",children:"User"}),e.jsx("option",{value:"admin",children:"Admin"})]})]}),e.jsx("button",{className:`action-btn ${t.is_banned?"unban-mobile":"ban-mobile"}`,onClick:()=>E(t.id,!t.is_banned),disabled:t.role==="admin",children:t.is_banned?"Unban User":"Ban User"})]})]},t.id))})]})},is=()=>{const[a,x]=r.useState([]),[T,y]=r.useState(!0),[h,w]=r.useState(""),[I,P]=r.useState(!1),[b,C]=r.useState(null),[E,z]=r.useState(!1),[t,j]=r.useState(!1),[i,U]=r.useState(!1),[D,V]=r.useState(null),[B,u]=r.useState([]),[f,k]=r.useState([]);r.useEffect(()=>{d()},[]),r.useEffect(()=>{const c=setInterval(()=>{d()},3e4);return()=>clearInterval(c)},[]);const d=async()=>{try{const{data:c,error:R}=await g.from("posts").select(`
          *,
          profiles: user_id (username, full_name)
        `).order("created_at",{ascending:!1}).limit(50);if(R)throw R;const W=await Promise.all((c||[]).map(async ee=>{const[se,re]=await Promise.all([g.from("likes").select("*",{count:"exact",head:!0}).eq("post_id",ee.id),g.from("comments").select("*",{count:"exact",head:!0}).eq("post_id",ee.id)]);return{...ee,likes:se.count||0,comments:re.count||0}}));x(W)}catch{}finally{y(!1)}},v=async c=>{if(confirm("Are you sure you want to delete this post? This action cannot be undone."))try{const{error:R}=await g.from("posts").delete().eq("id",c);if(R)throw R;d()}catch{alert("Failed to delete post")}},p=c=>{C(c),z(!0)},F=async c=>{try{const{error:R}=await g.from("posts").update({title:c.title,content:c.content,image_url:c.image_url,video_url:c.video_url,tags:c.tags,category:c.category,updated_at:new Date().toISOString()}).eq("id",c.id);if(R)throw R;z(!1),C(null),d(),alert("Post updated successfully!")}catch{alert("Failed to update post")}},_=()=>{z(!1),C(null)},$=async c=>{try{const{data:R,error:W}=await g.from("likes").select(`
          user_id,
          profiles: user_id (username, full_name, avatar_url)
        `).eq("post_id",c.id);if(W)throw W;u(R||[]),V(c),j(!0)}catch{}},m=async c=>{try{const{data:R,error:W}=await g.from("comments").select(`
          *,
          profiles: user_id (username, full_name, avatar_url)
        `).eq("post_id",c.id).order("created_at",{ascending:!1});if(W)throw W;k(R||[]),V(c),U(!0)}catch{}},L=()=>{j(!1),U(!1),V(null),u([]),k([])},Y=a.filter(c=>c.title?.toLowerCase().includes(h.toLowerCase())||c.profiles?.username?.toLowerCase().includes(h.toLowerCase()));return T?e.jsxs("div",{className:"content-section",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading posts..."})]}):e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Post Management"}),e.jsx("p",{children:"Manage blog posts and content"})]}),e.jsxs("div",{className:"management-controls",children:[e.jsxs("div",{className:"search-container",children:[e.jsx("button",{className:"search-toggle-btn",onClick:()=>P(!I),"aria-label":"Toggle search",children:e.jsx(de,{size:20})}),e.jsx("input",{type:"text",placeholder:"Search posts by title or author...",value:h,onChange:c=>w(c.target.value),className:`search-input ${I?"expanded":""}`}),h&&e.jsx("button",{className:"clear-search-btn",onClick:()=>w(""),"aria-label":"Clear search",children:e.jsx(A,{size:16})})]}),e.jsx("div",{className:"stats-summary",children:e.jsxs("span",{children:["Total Posts: ",a.length]})})]}),e.jsx("div",{className:"data-table-container desktop-table",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Description"}),e.jsx("th",{children:"Author"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"Likes"}),e.jsx("th",{children:"Comments"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:Y.map(c=>e.jsxs("tr",{children:[e.jsx("td",{children:c.title}),e.jsx("td",{className:"post-description",children:c.content?c.content.substring(0,50)+(c.content.length>50?"...":""):"No description"}),e.jsx("td",{children:c.profiles?.username||"Unknown"}),e.jsx("td",{children:new Date(c.created_at).toLocaleDateString()}),e.jsx("td",{children:e.jsxs("button",{className:"stat-link",onClick:()=>$(c),children:[c.likes||0," likes"]})}),e.jsx("td",{children:e.jsxs("button",{className:"stat-link",onClick:()=>m(c),children:[c.comments||0," comments"]})}),e.jsxs("td",{children:[e.jsx("button",{className:"action-btn edit",onClick:()=>p(c),children:"Edit"}),e.jsx("button",{className:"action-btn delete",onClick:()=>v(c.id),children:"Delete"})]})]},c.id))})]})}),e.jsx("div",{className:"mobile-cards-view",children:Y.map(c=>e.jsxs("div",{className:"post-card",children:[e.jsxs("div",{className:"post-card-header",children:[e.jsx("h3",{className:"post-card-title",children:c.title}),e.jsxs("div",{className:"post-card-meta",children:[e.jsx("span",{className:"post-author",children:c.profiles?.username||"Unknown"}),e.jsx("span",{className:"post-date",children:new Date(c.created_at).toLocaleDateString()})]})]}),e.jsx("div",{className:"post-card-content",children:e.jsx("p",{className:"post-description",children:c.content?c.content.substring(0,100)+(c.content.length>100?"...":""):"No description"})}),e.jsxs("div",{className:"post-card-stats",children:[e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-icon",children:"â¤ï¸"}),e.jsxs("button",{className:"stat-link-mobile",onClick:()=>$(c),children:[c.likes||0," likes"]})]}),e.jsxs("div",{className:"stat-item",children:[e.jsx("span",{className:"stat-icon",children:"ðŸ’¬"}),e.jsxs("button",{className:"stat-link-mobile",onClick:()=>m(c),children:[c.comments||0," comments"]})]})]}),e.jsxs("div",{className:"post-card-actions",children:[e.jsx("button",{className:"action-btn edit",onClick:()=>p(c),children:"Edit"}),e.jsx("button",{className:"action-btn delete",onClick:()=>v(c.id),children:"Delete"})]})]},c.id))}),E&&b&&e.jsx(ls,{post:b,onSave:F,onCancel:_}),t&&D&&e.jsx("div",{className:"modal-overlay",onClick:L,children:e.jsxs("div",{className:"modal-content likes-modal",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:['Likes for "',D.title,'"']}),e.jsx("button",{className:"close-btn",onClick:L,children:"Ã—"})]}),e.jsx("div",{className:"modal-body",children:B.length===0?e.jsx("p",{className:"no-data",children:"No likes yet"}):e.jsx("div",{className:"likes-list",children:B.map((c,R)=>e.jsxs("div",{className:"like-item",children:[e.jsx("div",{className:"user-avatar",children:c.profiles?.avatar_url?e.jsx("img",{src:c.profiles.avatar_url,alt:c.profiles.username}):e.jsx("div",{className:"default-avatar",children:"ðŸ‘¤"})}),e.jsx("div",{className:"user-info",children:e.jsx("span",{className:"username",children:c.profiles?.full_name||c.profiles?.username||"Anonymous"})})]},R))})})]})}),i&&D&&e.jsx("div",{className:"modal-overlay",onClick:L,children:e.jsxs("div",{className:"modal-content comments-modal",onClick:c=>c.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:['Comments for "',D.title,'"']}),e.jsx("button",{className:"close-btn",onClick:L,children:"Ã—"})]}),e.jsx("div",{className:"modal-body",children:f.length===0?e.jsx("p",{className:"no-data",children:"No comments yet"}):e.jsx("div",{className:"comments-list",children:f.map(c=>e.jsxs("div",{className:"comment-item",children:[e.jsx("div",{className:"user-avatar",children:c.profiles?.avatar_url?e.jsx("img",{src:c.profiles.avatar_url,alt:c.profiles.username}):e.jsx("div",{className:"default-avatar",children:"ðŸ‘¤"})}),e.jsxs("div",{className:"comment-content",children:[e.jsxs("div",{className:"comment-header",children:[e.jsx("span",{className:"username",children:c.profiles?.full_name||c.profiles?.username||"Anonymous"}),e.jsx("span",{className:"comment-date",children:new Date(c.created_at).toLocaleDateString()})]}),e.jsx("p",{className:"comment-text",children:c.content})]})]},c.id))})})]})})]})},ls=({post:a,onSave:x,onCancel:T})=>{const[y,h]=r.useState({title:a.title||"",content:a.content,images:a.image_url?JSON.parse(a.image_url):[],videos:a.video_url?JSON.parse(a.video_url):[],tags:a.tags||[],category:a.category||""}),[w,I]=r.useState(""),[P,b]=r.useState(""),[C,E]=r.useState(""),[z,t]=r.useState(!1),j=d=>{const{name:v,value:p}=d.target;h(F=>({...F,[v]:p}))},i=()=>{w.trim()&&!y.tags.includes(w.trim())&&(h(d=>({...d,tags:[...d.tags,w.trim()]})),I(""))},U=d=>{h(v=>({...v,tags:v.tags.filter(p=>p!==d)}))},D=(d,v)=>{const p=v==="image"?["image/jpeg","image/jpg","image/png","image/gif","image/webp"]:["video/mp4","video/avi","video/mov","video/wmv","video/webm","video/3gp","video/flv","video/m4v"];if(!p.includes(d.type))return alert(`Please select a valid ${v} file (${p.join(", ")})`),!1;const F=v==="image"?5*1024*1024:50*1024*1024;return d.size>F?(alert(`File size exceeds the maximum limit of ${v==="image"?"5MB":"50MB"} (Supabase platform limit). For larger files, please use external hosting and provide the URL instead.`),!1):!0},V=async(d,v)=>{const{data:{user:p}}=await g.auth.getUser();if(!p)throw new Error("You must be logged in to upload files");const F=d.name.split(".").pop(),_=`${Date.now()}-${Math.random().toString(36).substring(2)}.${F}`,$=`posts/${v}s/${_}`,{error:m}=await g.storage.from("storage").upload($,d,{cacheControl:"3600",upsert:!1});if(m)throw m;const{data:L}=g.storage.from("storage").getPublicUrl($);return L.publicUrl},B=async(d,v)=>{const{data:{user:p}}=await g.auth.getUser();if(!p){alert("You must be logged in to upload files");return}const F=Array.from(d);for(const $ of F)if(D($,v))try{const m=await V($,v);v==="image"?y.images.length<4?h(L=>({...L,images:[...L.images,m]})):alert("Maximum 4 images allowed"):h(L=>({...L,videos:[...L.videos||[],m]}))}catch{alert(`Failed to upload ${$.name}`)}const _=document.getElementById(v==="image"?"image-upload":"video-upload");_&&(_.value="")},u=()=>{P.trim()&&(h(d=>({...d,images:[...d.images,P.trim()]})),b(""))},f=()=>{C.trim()&&(h(d=>({...d,videos:[...d.videos||[],C.trim()]})),E(""))},k=async d=>{d.preventDefault(),t(!0);try{const v={...a,title:y.title,content:y.content,image_url:y.images.length>0?JSON.stringify(y.images):void 0,video_url:y.videos.length>0?JSON.stringify(y.videos):void 0,tags:y.tags,category:y.category};x(v)}catch{alert("Failed to prepare post update")}finally{t(!1)}};return e.jsx("div",{className:"modal-overlay",children:e.jsxs("div",{className:"modal-content edit-post-modal",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Edit Post"}),e.jsx("button",{className:"close-btn",onClick:T,children:"Ã—"})]}),e.jsxs("form",{onSubmit:k,className:"edit-post-form",children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-title",children:"Post Title"}),e.jsx("input",{type:"text",id:"edit-title",name:"title",value:y.title,onChange:j,placeholder:"Enter an engaging title...",required:!0,className:"form-input"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-content",children:"Content"}),e.jsx("textarea",{id:"edit-content",name:"content",value:y.content,onChange:j,placeholder:"Write your post content here...",required:!0,rows:8,className:"form-textarea"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"edit-category",children:"Category"}),e.jsxs("select",{id:"edit-category",name:"category",value:y.category,onChange:j,required:!0,className:"form-input",children:[e.jsx("option",{value:"",children:"Select a category"}),e.jsx("option",{value:"architectural design",children:"Architectural Design"}),e.jsx("option",{value:"construction",children:"Construction"}),e.jsx("option",{value:"interior design",children:"Interior Design"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Tags"}),e.jsxs("div",{className:"tag-input-group",children:[e.jsx("input",{type:"text",value:w,onChange:d=>I(d.target.value),placeholder:"Add a tag...",className:"form-input",onKeyDown:d=>d.key==="Enter"&&(d.preventDefault(),i())}),e.jsxs("button",{type:"button",onClick:i,className:"add-tag-btn",children:[e.jsx(K,{size:16}),"Add"]})]}),e.jsx("div",{className:"tags-display",children:y.tags.map((d,v)=>e.jsxs("span",{className:"tag",children:[e.jsx(je,{size:12}),d,e.jsx("button",{type:"button",onClick:()=>U(d),className:"remove-tag",children:e.jsx(A,{size:12})})]},v))})]})]}),e.jsx("div",{className:"form-section",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Media URLs"}),e.jsxs("div",{className:"media-upload-section",children:[e.jsxs("div",{className:"upload-group",children:[e.jsxs("label",{className:"upload-label",children:[e.jsx(le,{size:20}),"Images (",y.images.length,"/4)"]}),e.jsxs("div",{className:"url-input-group",children:[e.jsx("input",{type:"url",value:P,onChange:d=>b(d.target.value),placeholder:"Enter image URL...",className:"form-input",onKeyDown:d=>d.key==="Enter"&&(d.preventDefault(),u())}),e.jsx("button",{type:"button",onClick:u,className:"add-url-btn",children:"Add Image"})]}),e.jsxs("div",{className:"url-input-group",children:[e.jsxs("label",{htmlFor:"image-upload",style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",width:"100%"},children:[e.jsx(O,{size:16}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:d=>d.target.files&&B(d.target.files,"image"),className:"form-input",id:"image-upload",style:{padding:"0.5rem",flex:1}})]}),e.jsx("span",{style:{fontSize:"0.875rem",color:"#666",marginTop:"0.25rem"},children:"Max 4 images, unlimited file size"})]}),y.images.map((d,v)=>e.jsxs("div",{className:"media-preview",children:[e.jsx("img",{src:d,alt:`Preview ${v+1}`,className:"preview-image",onError:p=>{p.currentTarget.style.display="none",p.currentTarget.nextElementSibling?.classList.add("error")},onLoad:p=>{p.currentTarget.style.display="block"}}),e.jsx("div",{className:"image-error",style:{display:"none"},children:"Failed to load image"}),e.jsx("button",{type:"button",onClick:()=>{h(F=>({...F,images:F.images.filter((_,$)=>$!==v)}));const p=document.getElementById("image-upload");p&&(p.value="")},className:"remove-media",title:"Remove image",children:e.jsx(A,{size:16})})]},v))]}),e.jsxs("div",{className:"upload-group",children:[e.jsxs("label",{className:"upload-label",children:[e.jsx(ne,{size:20}),"Video"]}),e.jsxs("div",{className:"url-input-group",children:[e.jsx("input",{type:"url",value:C,onChange:d=>E(d.target.value),placeholder:"Enter video URL...",className:"form-input",onKeyDown:d=>d.key==="Enter"&&(d.preventDefault(),f())}),e.jsx("button",{type:"button",onClick:f,className:"add-url-btn",children:"Add Video"})]}),e.jsxs("div",{className:"url-input-group",children:[e.jsxs("label",{htmlFor:"video-upload",style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer",width:"100%"},children:[e.jsx(O,{size:16}),e.jsx("input",{type:"file",accept:"video/*",onChange:d=>d.target.files&&B(d.target.files,"video"),className:"form-input",id:"video-upload",style:{padding:"0.5rem",flex:1}})]}),e.jsx("span",{style:{fontSize:"0.875rem",color:"#666",marginTop:"0.25rem"},children:"Unlimited file size"})]}),y.videos&&y.videos.length>0&&y.videos.map((d,v)=>e.jsxs("div",{className:"media-preview",children:[e.jsx("video",{src:d,className:"preview-video",controls:!0}),e.jsx("button",{type:"button",onClick:()=>{h(F=>({...F,videos:F.videos.filter((_,$)=>$!==v)}));const p=document.getElementById("video-upload");p&&(p.value="")},className:"remove-media",title:"Remove video",children:e.jsx(A,{size:16})})]},v))]})]})]})})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:T,children:"Cancel"}),e.jsx("button",{type:"submit",className:"submit-btn",disabled:z,children:z?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner small"}),"Updating Post..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:16}),"Update Post"]})})]})]})]})})},ns=()=>{const[a,x]=r.useState([]),[T,y]=r.useState(!0),[h,w]=r.useState(""),[I,P]=r.useState(!1),[b,C]=r.useState(!1),[E,z]=r.useState(!1),[t,j]=r.useState(null),[i,U]=r.useState(""),[D,V]=r.useState(""),[B,u]=r.useState(!1);r.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:m,error:L}=await g.from("contact_messages").select("*").order("created_at",{ascending:!1});if(L)throw L;x(m||[])}catch{}finally{y(!1)}},k=async(m,L)=>{try{const{error:Y}=await g.from("contact_messages").update({status:L,updated_at:new Date().toISOString()}).eq("id",m);if(Y)throw Y;f()}catch{alert("Failed to update message status")}},d=async m=>{if(m.preventDefault(),!(!t||!i.trim())){u(!0);try{const{error:L}=await g.functions.invoke("send-contact-reply",{body:{contactMessageId:t.id,replyMessage:i.trim(),replySubject:D.trim()||void 0}});if(L)throw L;alert("Reply sent successfully!"),C(!1),U(""),V(""),j(null),f()}catch{alert("Failed to send reply")}finally{u(!1)}}},v=m=>{j(m),V(`Re: ${m.subject||"Your Contact Message"}`),C(!0)},p=m=>{j(m),z(!0)},F=()=>{C(!1),z(!1),j(null),U(""),V("")},_=a.filter(m=>m.name?.toLowerCase().includes(h.toLowerCase())||m.email?.toLowerCase().includes(h.toLowerCase())||m.subject?.toLowerCase().includes(h.toLowerCase())||m.message?.toLowerCase().includes(h.toLowerCase())),$=m=>({pending:"status-pending",read:"status-read",replied:"status-replied"})[m]||"status-pending";return T?e.jsxs("div",{className:"content-section",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading contact messages..."})]}):e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Contact Messages"}),e.jsx("p",{children:"Manage and respond to contact form submissions"})]}),e.jsxs("div",{className:"management-controls",children:[e.jsxs("div",{className:"search-container",children:[e.jsx("button",{className:"search-toggle-btn",onClick:()=>P(!I),"aria-label":"Toggle search",children:e.jsx(de,{size:20})}),e.jsx("input",{type:"text",placeholder:"Search messages by name, email, subject, or content...",value:h,onChange:m=>w(m.target.value),className:`search-input ${I?"expanded":""}`}),h&&e.jsx("button",{className:"clear-search-btn",onClick:()=>w(""),"aria-label":"Clear search",children:e.jsx(A,{size:16})})]}),e.jsxs("div",{className:"stats-summary",children:[e.jsxs("span",{children:["Total Messages: ",a.length]}),e.jsxs("span",{children:["Pending: ",a.filter(m=>m.status==="pending").length]}),e.jsxs("span",{children:["Replied: ",a.filter(m=>m.status==="replied").length]})]})]}),e.jsx("div",{className:"data-table-container desktop-table",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Subject"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:_.map(m=>e.jsxs("tr",{children:[e.jsx("td",{children:m.name}),e.jsx("td",{children:m.email}),e.jsx("td",{children:m.subject||"No subject"}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${$(m.status)}`,children:m.status})}),e.jsx("td",{children:new Date(m.created_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsx("button",{className:"action-btn view",onClick:()=>p(m),children:"View"}),m.status!=="replied"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"action-btn mark-read",onClick:()=>k(m.id,"read"),children:"Mark Read"}),e.jsx("button",{className:"action-btn reply",onClick:()=>v(m),children:"Reply"})]})]})]},m.id))})]})}),e.jsx("div",{className:"mobile-cards-view",children:_.map(m=>e.jsxs("div",{className:"message-card",children:[e.jsxs("div",{className:"message-card-header",children:[e.jsxs("div",{className:"message-info",children:[e.jsx("h3",{className:"message-name",children:m.name}),e.jsx("p",{className:"message-email",children:m.email}),e.jsx("div",{className:"message-status",children:e.jsx("span",{className:`status-badge ${$(m.status)}`,children:m.status})})]}),e.jsx("span",{className:"message-date",children:new Date(m.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"message-card-content",children:[e.jsx("h4",{className:"message-subject",children:m.subject||"No subject"}),e.jsx("p",{className:"message-preview",children:m.message.length>100?m.message.substring(0,100)+"...":m.message})]}),e.jsxs("div",{className:"message-card-actions",children:[e.jsx("button",{className:"action-btn view",onClick:()=>p(m),children:"View Details"}),m.status!=="replied"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"action-btn mark-read",onClick:()=>k(m.id,"read"),children:"Mark Read"}),e.jsx("button",{className:"action-btn reply",onClick:()=>v(m),children:"Reply"})]})]})]},m.id))}),b&&t&&e.jsx("div",{className:"modal-overlay",onClick:F,children:e.jsxs("div",{className:"modal-content reply-modal",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsxs("h2",{children:["Reply to ",t.name]}),e.jsx("button",{className:"close-btn",onClick:F,children:"Ã—"})]}),e.jsxs("form",{onSubmit:d,className:"reply-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"reply-subject",children:"Subject"}),e.jsx("input",{type:"text",id:"reply-subject",value:D,onChange:m=>V(m.target.value),className:"form-input",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"reply-message",children:"Your Reply"}),e.jsx("textarea",{id:"reply-message",value:i,onChange:m=>U(m.target.value),placeholder:"Type your reply message here...",rows:8,className:"form-textarea",required:!0})]}),e.jsxs("div",{className:"original-message",children:[e.jsx("h4",{children:"Original Message:"}),e.jsxs("div",{className:"original-content",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Subject:"})," ",t.subject||"No subject"]}),e.jsx("p",{children:e.jsx("strong",{children:"Message:"})}),e.jsx("div",{className:"original-text",children:t.message})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"button",className:"cancel-btn",onClick:F,children:"Cancel"}),e.jsx("button",{type:"submit",className:"submit-btn",disabled:B,children:B?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner small"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:16}),"Send Reply"]})})]})]})]})}),E&&t&&e.jsx("div",{className:"modal-overlay",onClick:F,children:e.jsxs("div",{className:"modal-content details-modal",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Message Details"}),e.jsx("button",{className:"close-btn",onClick:F,children:"Ã—"})]}),e.jsxs("div",{className:"modal-body",children:[e.jsxs("div",{className:"message-details",children:[e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Name:"}),e.jsx("span",{className:"detail-value",children:t.name})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Email:"}),e.jsx("span",{className:"detail-value",children:t.email})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Subject:"}),e.jsx("span",{className:"detail-value",children:t.subject||"No subject"})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Status:"}),e.jsx("span",{className:`detail-value status-${t.status}`,children:t.status})]}),e.jsxs("div",{className:"detail-row",children:[e.jsx("span",{className:"detail-label",children:"Date:"}),e.jsx("span",{className:"detail-value",children:new Date(t.created_at).toLocaleString()})]}),e.jsxs("div",{className:"detail-row message-content",children:[e.jsx("span",{className:"detail-label",children:"Message:"}),e.jsx("div",{className:"detail-value message-text",children:t.message})]})]}),t.status!=="replied"&&e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{className:"action-btn mark-read",onClick:()=>{k(t.id,"read"),F()},children:"Mark as Read"}),e.jsx("button",{className:"action-btn reply",onClick:()=>{F(),v(t)},children:"Reply to Message"})]})]})]})})]})},rs=()=>{const[a,x]=r.useState({subject:"",content:""}),[T,y]=r.useState(!1),[h,w]=r.useState(null),I=C=>{const{name:E,value:z}=C.target;x(t=>({...t,[E]:z}))},P=C=>{x(E=>({...E,content:C||""}))},b=async C=>{if(C.preventDefault(),!a.subject.trim()||!a.content.trim()){alert("Please fill in both subject and content");return}y(!0),w({isSending:!0,current:0,total:0,message:"Preparing newsletter..."});try{const{data:E,error:z}=await g.from("email_subscriptions").select("email",{count:"exact",head:!0}).eq("is_active",!0);if(z)throw z;const t=E?.length||0;w({isSending:!0,current:0,total:t,message:`Sending to ${t} subscribers...`});const{error:j}=await g.functions.invoke("send-newsletter",{body:{subject:a.subject.trim(),content:a.content.trim()}});if(j)throw j;w({isSending:!1,current:t,total:t,message:`Newsletter sent successfully to ${t} subscribers!`}),setTimeout(()=>{x({subject:"",content:""}),w(null)},3e3)}catch{w({isSending:!1,current:0,total:0,message:"Failed to send newsletter. Please try again."})}finally{y(!1)}};return e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Send Newsletter"}),e.jsx("p",{children:"Send newsletters to all active subscribers"})]}),e.jsxs("form",{onSubmit:b,className:"newsletter-form",children:[e.jsx("div",{className:"form-grid",children:e.jsxs("div",{className:"form-section",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"subject",children:"Subject Line"}),e.jsx("input",{type:"text",id:"subject",name:"subject",value:a.subject,onChange:I,placeholder:"Enter newsletter subject...",required:!0,className:"form-input",disabled:T})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Content (Markdown)"}),e.jsx("div",{"data-color-mode":"light",className:"markdown-editor",children:e.jsx(Ze,{value:a.content,onChange:P,preview:"edit",hideToolbar:!1,textareaProps:{placeholder:"Write your newsletter content here...",disabled:T}})})]})]})}),h&&e.jsxs("div",{className:"sending-progress",children:[e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:h.total>0?`${h.current/h.total*100}%`:"0%"}})}),e.jsx("p",{className:"progress-message",children:h.message}),h.isSending&&e.jsx("div",{className:"loading-spinner small"})]}),e.jsx("div",{className:"form-actions",children:e.jsx("button",{type:"submit",className:"submit-btn",disabled:T||!a.subject.trim()||!a.content.trim(),children:T?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner small"}),"Sending Newsletter..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Fe,{size:16}),"Send Newsletter"]})})})]})]})},os=()=>{const[a,x]=r.useState([]),[T,y]=r.useState(!0),[h,w]=r.useState(""),[I,P]=r.useState(!1);r.useEffect(()=>{b()},[]);const b=async()=>{try{const{data:t,error:j}=await g.from("email_subscriptions").select("*").order("subscribed_at",{ascending:!1});if(j)throw j;x(t||[])}catch{}finally{y(!1)}},C=async(t,j)=>{try{const{error:i}=await g.from("email_subscriptions").update({is_active:!j}).eq("id",t);if(i)throw i;b()}catch{alert("Failed to update subscription status")}},E=async t=>{if(confirm("Are you sure you want to delete this email subscription? This action cannot be undone."))try{const{error:j}=await g.from("email_subscriptions").delete().eq("id",t);if(j)throw j;b()}catch{alert("Failed to delete subscription")}},z=a.filter(t=>t.email?.toLowerCase().includes(h.toLowerCase()));return T?e.jsxs("div",{className:"content-section",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading email subscriptions..."})]}):e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Email Subscriptions"}),e.jsx("p",{children:"Manage email newsletter subscriptions"})]}),e.jsxs("div",{className:"management-controls",children:[e.jsxs("div",{className:"search-container",children:[e.jsx("button",{className:"search-toggle-btn",onClick:()=>P(!I),"aria-label":"Toggle search",children:e.jsx(de,{size:20})}),e.jsx("input",{type:"text",placeholder:"Search subscriptions by email...",value:h,onChange:t=>w(t.target.value),className:`search-input ${I?"expanded":""}`}),h&&e.jsx("button",{className:"clear-search-btn",onClick:()=>w(""),"aria-label":"Clear search",children:e.jsx(A,{size:16})})]}),e.jsxs("div",{className:"stats-summary",children:[e.jsxs("span",{children:["Total Subscriptions: ",a.length]}),e.jsxs("span",{children:["Active: ",a.filter(t=>t.is_active).length]})]})]}),e.jsx("div",{className:"data-table-container desktop-table",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Subscribed Date"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:z.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.email}),e.jsx("td",{children:new Date(t.subscribed_at).toLocaleDateString()}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${t.is_active?"active":"inactive"}`,children:t.is_active?"Active":"Inactive"})}),e.jsxs("td",{children:[e.jsx("button",{className:`action-btn ${t.is_active?"deactivate":"activate"}`,onClick:()=>C(t.id,t.is_active),children:t.is_active?"Deactivate":"Activate"}),e.jsx("button",{className:"action-btn delete",onClick:()=>E(t.id),children:"Delete"})]})]},t.id))})]})}),e.jsx("div",{className:"mobile-cards-view",children:z.map(t=>e.jsxs("div",{className:"subscription-card",children:[e.jsxs("div",{className:"subscription-card-header",children:[e.jsxs("div",{className:"subscription-info",children:[e.jsx("h3",{className:"subscription-email",children:t.email}),e.jsx("div",{className:"subscription-status",children:e.jsx("span",{className:`status-badge ${t.is_active?"active":"inactive"}`,children:t.is_active?"Active":"Inactive"})})]}),e.jsx("span",{className:"subscription-date",children:new Date(t.subscribed_at).toLocaleDateString()})]}),e.jsxs("div",{className:"subscription-card-actions",children:[e.jsx("button",{className:`action-btn ${t.is_active?"deactivate-mobile":"activate-mobile"}`,onClick:()=>C(t.id,t.is_active),children:t.is_active?"Deactivate":"Activate"}),e.jsx("button",{className:"action-btn delete",onClick:()=>E(t.id),children:"Delete"})]})]},t.id))})]})},cs=()=>{const[a,x]=r.useState({title:"",description:"",status:"ongoing",image:"",location:"",category:"",height:"",floors:"",area:"",completion:"",units:"",bedrooms:"",length:"",lanes:"",specifications:{},timeline:"",materials:[],features:[],imageGallery:[],blueprints:[],videos:[],virtualTour:""}),[T,y]=r.useState(""),[h,w]=r.useState(""),[I,P]=r.useState(""),[b,C]=r.useState(""),[E,z]=r.useState(""),[t,j]=r.useState(""),[i,U]=r.useState(""),[D,V]=r.useState(""),[B,u]=r.useState(!1),[f,k]=r.useState(!1),[d,v]=r.useState({}),p=l=>{const{name:o,value:S}=l.target;x(q=>({...q,[o]:S})),d[o]&&v(q=>({...q,[o]:""}))},F=()=>{T.trim()&&h.trim()&&(x(l=>({...l,specifications:{...l.specifications,[T.trim()]:h.trim()}})),y(""),w(""))},_=l=>{const o={...a.specifications};delete o[l],x(S=>({...S,specifications:o}))},$=()=>{I.trim()&&!a.materials.includes(I.trim())&&(x(l=>({...l,materials:[...l.materials,I.trim()]})),P(""))},m=l=>{x(o=>({...o,materials:o.materials.filter(S=>S!==l)}))},L=()=>{b.trim()&&!a.features.includes(b.trim())&&(x(l=>({...l,features:[...l.features,b.trim()]})),C(""))},Y=l=>{x(o=>({...o,features:o.features.filter(S=>S!==l)}))},c=()=>{E.trim()&&!a.imageGallery.includes(E.trim())&&(x(l=>({...l,imageGallery:[...l.imageGallery,E.trim()]})),z(""))},R=l=>{x(o=>({...o,imageGallery:o.imageGallery.filter(S=>S!==l)}))},W=()=>{t.trim()&&!a.blueprints.includes(t.trim())&&(x(l=>({...l,blueprints:[...l.blueprints,t.trim()]})),j(""))},ee=l=>{x(o=>({...o,blueprints:o.blueprints.filter(S=>S!==l)}))},se=()=>{if(i.trim()&&D.trim()){const l={url:i.trim(),type:"external",thumbnail:D.trim()};x(o=>({...o,videos:[...o.videos,l]})),U(""),V("")}},re=l=>{x(o=>({...o,videos:o.videos.filter((S,q)=>q!==l)}))},ae=(l,o)=>(o==="image"?l.type.startsWith("image/"):l.type.startsWith("video/"))?!0:(alert(`Please select a valid ${o} file. Any ${o} type is supported.`),!1),oe=async(l,o,S)=>{const{data:{user:q}}=await g.auth.getUser();if(!q)throw new Error("You must be logged in to upload files");const J=l.name.split(".").pop(),ce=`${Date.now()}-${Math.random().toString(36).substring(2)}.${J}`;let Q="images";o==="video"&&(Q="videos"),o==="thumbnail"&&(Q="thumbnails"),o==="blueprint"&&(Q="blueprints");const he=`projects/${S}/${Q}/${ce}`,{error:pe}=await g.storage.from("portfolio").upload(he,l,{cacheControl:"3600",upsert:!1});if(pe)throw pe;const{data:ve}=g.storage.from("portfolio").getPublicUrl(he);return ve.publicUrl},me=async l=>{if(l&&ae(l,"image")){k(!0);try{const o=await oe(l,"thumbnail","temp");x(S=>({...S,image:o}))}catch(o){const S=o instanceof Error?o.message:"Unknown error";alert(`Failed to upload main image: ${S}`)}finally{k(!1)}}},ue=async l=>{if(l.preventDefault(),!a.title||!a.description||!a.image||!a.location){alert("Please fill in all required fields");return}u(!0);try{const{data:{user:o}}=await g.auth.getUser();if(!o)throw new Error("Not authenticated");const S={...a.specifications};a.height&&(S.height=a.height),a.floors&&(S.floors=a.floors),a.area&&(S.area=a.area),a.completion&&(S.completion=a.completion),a.units&&(S.units=a.units),a.bedrooms&&(S.bedrooms=a.bedrooms),a.length&&(S.length=a.length),a.lanes&&(S.lanes=a.lanes);const q={specifications:Object.keys(S).length>0?S:void 0,timeline:a.timeline||void 0,materials:a.materials.length>0?a.materials:void 0,features:a.features.length>0?a.features:void 0,imageGallery:a.imageGallery.length>0?a.imageGallery:void 0,blueprints:a.blueprints.length>0?a.blueprints:void 0,videos:a.videos.length>0?a.videos:void 0,virtualTour:a.virtualTour||void 0},{error:J}=await g.from("projects").insert({title:a.title,description:a.description,status:a.status,image:a.image,location:a.location,category:a.category||null,details:q,created_by:o.id});if(J)throw J;alert("Project created successfully! All images have been uploaded and saved."),x({title:"",description:"",status:"ongoing",image:"",location:"",category:"",height:"",floors:"",area:"",completion:"",units:"",bedrooms:"",length:"",lanes:"",specifications:{},timeline:"",materials:[],features:[],imageGallery:[],blueprints:[],videos:[],virtualTour:""})}catch(o){const S=o instanceof Error?o.message:"Unknown error";alert("Failed to create project: "+S)}finally{u(!1)}};return e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Create New Project"}),e.jsx("p",{children:"Add a new project to the portfolio"})]}),e.jsxs("form",{onSubmit:ue,className:"project-form",children:[e.jsxs("div",{className:"form-group project-title-group",children:[e.jsxs("label",{htmlFor:"title",className:"project-title-label",children:[e.jsx(ye,{size:20,className:"title-icon"}),"Project Title"]}),e.jsx("input",{type:"text",id:"title",name:"title",value:a.title,onChange:p,required:!0,placeholder:"e.g., The Metropol",className:"form-input project-title-input"})]}),e.jsxs("div",{className:"form-group description-group",children:[e.jsxs("label",{htmlFor:"description",className:"description-label",children:[e.jsx(Z,{size:20,className:"description-icon"}),"Description"]}),e.jsx("textarea",{id:"description",name:"description",value:a.description,onChange:p,required:!0,rows:4,placeholder:"Project description...",className:"form-textarea description-textarea"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group status-group",children:[e.jsxs("label",{htmlFor:"status",className:"status-label",children:[e.jsx(Ee,{size:20,className:"status-icon"}),"Status"]}),e.jsxs("select",{id:"status",name:"status",value:a.status,onChange:p,required:!0,className:"form-input status-select",children:[e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"form-group category-group",children:[e.jsxs("label",{htmlFor:"category",className:"category-label",children:[e.jsx(je,{size:20,className:"category-icon"}),"Category"]}),e.jsxs("select",{id:"category",name:"category",value:a.category,onChange:p,className:"form-input category-select",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"residential",children:"Residential"}),e.jsx("option",{value:"commercial",children:"Commercial"}),e.jsx("option",{value:"town-houses",children:"Town Houses"}),e.jsx("option",{value:"group-dualling",children:"Group Dualling"}),e.jsx("option",{value:"architectural",children:"Architectural"})]})]})]}),e.jsxs("div",{className:"form-group image-group",children:[e.jsxs("label",{htmlFor:"image",className:"image-label",children:[e.jsx(le,{size:20,className:"image-icon"}),"Main Image (Thumbnail) *"]}),e.jsx("div",{className:"input-with-button",style:{marginBottom:"10px"},children:e.jsx("input",{type:"url",id:"image",name:"image",value:a.image,onChange:p,required:!0,placeholder:"Image URL or upload file below",className:"form-input image-url-input"})}),e.jsxs("div",{className:"upload-group",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:l=>{const o=l.target.files?.[0]||null;me(o),l.target.value=""},style:{display:"none"},id:"main-image-upload"}),e.jsxs("label",{htmlFor:"main-image-upload",className:"upload-btn",children:[e.jsx(O,{size:16}),"Upload Main Image"]}),f&&e.jsx("span",{style:{marginLeft:"10px"},children:"Uploading..."})]}),a.image&&e.jsx("div",{style:{marginTop:"10px"},children:e.jsx("img",{src:a.image,alt:"Main image preview",style:{maxWidth:"200px",maxHeight:"200px",objectFit:"cover",borderRadius:"4px"}})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"#666",marginTop:"5px"},children:"Upload a main thumbnail image or provide a URL. This image will be displayed on the Projects page."})]}),e.jsxs("div",{className:"form-group location-group",children:[e.jsxs("label",{htmlFor:"location",className:"location-label",children:[e.jsx(ze,{size:20,className:"location-icon"}),"Location *"]}),e.jsx("input",{type:"text",id:"location",name:"location",value:a.location,onChange:p,required:!0,placeholder:"e.g., Accra, Ghana",className:"form-input location-input"})]}),e.jsxs("div",{className:"form-group timeline-group",children:[e.jsxs("label",{htmlFor:"timeline",className:"timeline-label",children:[e.jsx(Te,{size:20,className:"timeline-icon"}),"Timeline"]}),e.jsx("input",{type:"text",id:"timeline",name:"timeline",value:a.timeline,onChange:p,placeholder:"e.g., 2018-2025",className:"form-input timeline-input"})]}),e.jsxs("div",{className:"form-group virtual-tour-group",children:[e.jsxs("label",{htmlFor:"virtualTour",className:"virtual-tour-label",children:[e.jsx(Ie,{size:20,className:"virtual-tour-icon"}),"Virtual Tour URL"]}),e.jsx("input",{type:"url",id:"virtualTour",name:"virtualTour",value:a.virtualTour,onChange:p,placeholder:"https://...",className:"form-input virtual-tour-input"})]}),e.jsxs("div",{className:"form-group specifications-group",children:[e.jsxs("label",{className:"specifications-label",children:[e.jsx(Le,{size:20,className:"specifications-icon"}),"Specifications"]}),e.jsxs("div",{className:"common-specs-grid",children:[e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"height",children:"Height"}),e.jsx("input",{type:"text",id:"height",name:"height",value:a.height,onChange:p,placeholder:"e.g., 300m"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"floors",children:"Floors"}),e.jsx("input",{type:"text",id:"floors",name:"floors",value:a.floors,onChange:p,placeholder:"e.g., 80"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"area",children:"Area"}),e.jsx("input",{type:"text",id:"area",name:"area",value:a.area,onChange:p,placeholder:"e.g., 150,000 sq ft"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"completion",children:"Completion"}),e.jsx("input",{type:"text",id:"completion",name:"completion",value:a.completion,onChange:p,placeholder:"e.g., 2022"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"units",children:"Units"}),e.jsx("input",{type:"text",id:"units",name:"units",value:a.units,onChange:p,placeholder:"e.g., 120"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"bedrooms",children:"Bedrooms"}),e.jsx("input",{type:"text",id:"bedrooms",name:"bedrooms",value:a.bedrooms,onChange:p,placeholder:"e.g., 8"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"length",children:"Length"}),e.jsx("input",{type:"text",id:"length",name:"length",value:a.length,onChange:p,placeholder:"e.g., 2.5km"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"lanes",children:"Lanes"}),e.jsx("input",{type:"text",id:"lanes",name:"lanes",value:a.lanes,onChange:p,placeholder:"e.g., 6"})]})]}),e.jsxs("div",{className:"dynamic-specs-section",children:[e.jsx("h4",{children:"Additional Specifications"}),e.jsxs("div",{className:"spec-input-group",children:[e.jsx("input",{type:"text",placeholder:"Key (e.g., parking spaces)",value:T,onChange:l=>y(l.target.value),className:"spec-input"}),e.jsx("input",{type:"text",placeholder:"Value (e.g., 500)",value:h,onChange:l=>w(l.target.value),className:"spec-input"}),e.jsxs("button",{type:"button",onClick:F,className:"add-btn",children:[e.jsx(K,{size:16})," Add"]})]}),e.jsx("div",{className:"tags-list",children:Object.entries(a.specifications).map(([l,o])=>e.jsxs("span",{className:"tag",children:[l,": ",o,e.jsx("button",{type:"button",onClick:()=>_(l),className:"tag-remove",children:e.jsx(A,{size:12})})]},l))})]})]}),e.jsxs("div",{className:"form-group materials-group",children:[e.jsxs("label",{className:"materials-label",children:[e.jsx(Me,{size:20,className:"materials-icon"}),"Materials"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"text",placeholder:"Add material",value:I,onChange:l=>P(l.target.value),onKeyDown:l=>l.key==="Enter"&&(l.preventDefault(),$()),className:"material-input"}),e.jsx("button",{type:"button",onClick:$,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsx("div",{className:"tags-list",children:a.materials.map((l,o)=>e.jsxs("span",{className:"tag",children:[l,e.jsx("button",{type:"button",onClick:()=>m(l),className:"tag-remove",children:e.jsx(A,{size:12})})]},o))})]}),e.jsxs("div",{className:"form-group features-group",children:[e.jsxs("label",{className:"features-label",children:[e.jsx(De,{size:20,className:"features-icon"}),"Features"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"text",placeholder:"Add feature",value:b,onChange:l=>C(l.target.value),onKeyDown:l=>l.key==="Enter"&&(l.preventDefault(),L()),className:"feature-input"}),e.jsx("button",{type:"button",onClick:L,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsx("div",{className:"tags-list",children:a.features.map((l,o)=>e.jsxs("span",{className:"tag",children:[l,e.jsx("button",{type:"button",onClick:()=>Y(l),className:"tag-remove",children:e.jsx(A,{size:12})})]},o))})]}),e.jsxs("div",{className:"form-group image-gallery-group",children:[e.jsxs("label",{className:"image-gallery-label",children:[e.jsx(_e,{size:20,className:"image-gallery-icon"}),"Image Gallery (Unlimited Images)"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"url",placeholder:"Image URL (or upload files below)",value:E,onChange:l=>z(l.target.value),className:"gallery-url-input"}),e.jsx("button",{type:"button",onClick:c,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsxs("div",{className:"upload-group",style:{marginTop:"10px"},children:[e.jsx("label",{className:"upload-label",style:{display:"block",marginBottom:"8px"},children:"Upload Images (Multiple files supported)"}),e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:async l=>{if(l.target.files){const o=Array.from(l.target.files),S=[];for(const q of o)if(ae(q,"image"))try{const J=await oe(q,"image","temp");S.push(J)}catch{alert(`Failed to upload ${q.name}`)}x(q=>({...q,imageGallery:[...q.imageGallery,...S]}))}l.target.value=""},style:{display:"none"},id:"image-file-upload"}),e.jsxs("label",{htmlFor:"image-file-upload",className:"upload-btn",children:[e.jsx(O,{size:16}),"Select Images (Multiple)"]})]}),e.jsx("div",{className:"tags-list",style:{marginTop:"10px"},children:a.imageGallery.map((l,o)=>e.jsxs("span",{className:"tag",children:[e.jsx(le,{size:12})," Image ",o+1,e.jsx("button",{type:"button",onClick:()=>R(l),className:"tag-remove",children:e.jsx(A,{size:12})})]},o))}),e.jsx("p",{style:{fontSize:"0.85rem",color:"#666",marginTop:"5px"},children:"Tip: You can add unlimited images via URL or file upload. For file uploads, create the project first, then use the edit form to upload files."})]}),e.jsxs("div",{className:"form-group videos-group",children:[e.jsxs("label",{className:"videos-label",children:[e.jsx(ne,{size:20,className:"videos-icon"}),"Videos (Unlimited Videos)"]}),e.jsxs("div",{className:"video-input-group",children:[e.jsx("input",{type:"url",placeholder:"Video URL (YouTube, Vimeo, or direct link)",value:i,onChange:l=>U(l.target.value),className:"video-url-input"}),e.jsx("input",{type:"url",placeholder:"Thumbnail URL (optional)",value:D,onChange:l=>V(l.target.value),className:"video-thumbnail-input"}),e.jsx("button",{type:"button",onClick:se,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsxs("div",{className:"upload-group",style:{marginTop:"10px"},children:[e.jsx("label",{className:"upload-label",style:{display:"block",marginBottom:"8px"},children:"Upload Videos (Multiple files supported)"}),e.jsx("input",{type:"file",accept:"video/*",multiple:!0,onChange:async l=>{if(l.target.files){const o=Array.from(l.target.files);for(const S of o)if(ae(S,"video"))try{const ce={url:await oe(S,"video","temp"),type:"local",thumbnail:"https://via.placeholder.com/300x200?text=Video+Thumbnail"};x(Q=>({...Q,videos:[...Q.videos,ce]}))}catch{alert(`Failed to upload ${S.name}`)}}l.target.value=""},style:{display:"none"},id:"video-file-upload"}),e.jsxs("label",{htmlFor:"video-file-upload",className:"upload-btn",children:[e.jsx(O,{size:16}),"Select Videos (Multiple)"]})]}),e.jsx("div",{className:"tags-list",style:{marginTop:"10px"},children:a.videos.map((l,o)=>e.jsxs("span",{className:"tag",children:[e.jsx(ne,{size:12})," ",l.type," Video",e.jsx("button",{type:"button",onClick:()=>re(o),className:"tag-remove",children:e.jsx(A,{size:12})})]},o))}),e.jsx("p",{style:{fontSize:"0.85rem",color:"#666",marginTop:"5px"},children:"Tip: You can add unlimited videos via URL or file upload. For file uploads, create the project first, then use the edit form to upload files."})]}),e.jsxs("div",{className:"form-group blueprints-group",children:[e.jsxs("label",{className:"blueprints-label",children:[e.jsx(Pe,{size:20,className:"blueprints-icon"}),"Blueprints"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"url",placeholder:"Blueprint URL",value:t,onChange:l=>j(l.target.value),className:"blueprint-url-input"}),e.jsx("button",{type:"button",onClick:W,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsx("div",{className:"tags-list",children:a.blueprints.map((l,o)=>e.jsxs("span",{className:"tag",children:["Blueprint ",o+1,e.jsx("button",{type:"button",onClick:()=>ee(l),className:"tag-remove",children:e.jsx(A,{size:12})})]},o))})]}),e.jsx("button",{type:"submit",className:"submit-btn",disabled:B,children:B?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner small"}),"Creating Project..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:16}),"Create Project"]})})]})]})},ds=()=>{const[a,x]=r.useState([]),[T,y]=r.useState(!0),[h,w]=r.useState(""),[I,P]=r.useState(!1),[b,C]=r.useState(null),[E,z]=r.useState(!1);r.useEffect(()=>{t()},[]);const t=async()=>{try{const{data:s,error:n}=await g.from("projects").select("*").order("created_at",{ascending:!1});if(n)throw n;x(s||[])}catch{}finally{y(!1)}},j=async s=>{if(confirm("Are you sure you want to delete this project? This will also delete all associated images and videos from storage."))try{const{data:n,error:N}=await g.from("projects").select("*").eq("id",s).single();if(N)throw N;const M=[];if(n.image&&M.push(n.image),n.details){const G=n.details;G.imageGallery&&Array.isArray(G.imageGallery)&&M.push(...G.imageGallery),G.videos&&Array.isArray(G.videos)&&G.videos.forEach(X=>{X.url&&M.push(X.url),X.thumbnail&&M.push(X.thumbnail)}),G.blueprints&&Array.isArray(G.blueprints)&&M.push(...G.blueprints)}const H=M.map(async G=>{try{if(G.includes("supabase.co/storage/v1/object/public/portfolio/")){const X=G.split("/storage/v1/object/public/portfolio/");if(X.length===2){const ge=X[1];try{const{error:ie}=await g.storage.from("portfolio").remove([ge]);ie&&(ie.message?.includes("bucket_id")||ie.message?.includes("not found"))}catch{}}}}catch{}});await Promise.all(H);const{error:te}=await g.from("projects").delete().eq("id",s);if(te)throw te;t(),alert("Project and all associated files deleted successfully")}catch{alert("Failed to delete project")}},[i,U]=r.useState({title:"",description:"",status:"ongoing",image:"",location:"",category:"",height:"",floors:"",area:"",completion:"",units:"",bedrooms:"",length:"",lanes:"",specifications:{},timeline:"",materials:[],features:[],imageGallery:[],blueprints:[],videos:[],virtualTour:""}),[D,V]=r.useState(""),[B,u]=r.useState(""),[f,k]=r.useState(""),[d,v]=r.useState(""),[p,F]=r.useState(""),[_,$]=r.useState(""),[m,L]=r.useState(""),[Y,c]=r.useState(""),[R,W]=r.useState(!1),[ee,se]=r.useState(!1),[re,ae]=r.useState(!1),[oe,me]=r.useState(!1),ue=s=>{const n=s.details||{},N=n.specifications||{};U({title:s.title||"",description:s.description||"",status:s.status||"ongoing",image:s.image||"",location:s.location||"",category:s.category||"",height:N.height||"",floors:N.floors||"",area:N.area||"",completion:N.completion||"",units:N.units||"",bedrooms:N.bedrooms||"",length:N.length||"",lanes:N.lanes||"",specifications:Object.fromEntries(Object.entries(N).filter(([M])=>!["height","floors","area","completion","units","bedrooms","length","lanes"].includes(M))),timeline:n.timeline||"",materials:n.materials||[],features:n.features||[],imageGallery:n.imageGallery||[],blueprints:n.blueprints||[],videos:n.videos||[],virtualTour:n.virtualTour||""}),C(s),z(!0)},l=()=>{C(null),z(!1),U({title:"",description:"",status:"ongoing",image:"",location:"",category:"",height:"",floors:"",area:"",completion:"",units:"",bedrooms:"",length:"",lanes:"",specifications:{},timeline:"",materials:[],features:[],imageGallery:[],blueprints:[],videos:[],virtualTour:""}),V(""),u(""),k(""),v(""),F(""),$(""),L(""),c("")},o=s=>{const{name:n,value:N}=s.target;U(M=>({...M,[n]:N}))},S=()=>{D.trim()&&B.trim()&&(U(s=>({...s,specifications:{...s.specifications,[D.trim()]:B.trim()}})),V(""),u(""))},q=s=>{const n={...i.specifications};delete n[s],U(N=>({...N,specifications:n}))},J=()=>{f.trim()&&!i.materials.includes(f.trim())&&(U(s=>({...s,materials:[...s.materials,f.trim()]})),k(""))},ce=s=>{U(n=>({...n,materials:n.materials.filter(N=>N!==s)}))},Q=()=>{d.trim()&&!i.features.includes(d.trim())&&(U(s=>({...s,features:[...s.features,d.trim()]})),v(""))},he=s=>{U(n=>({...n,features:n.features.filter(N=>N!==s)}))},pe=()=>{p.trim()&&!i.imageGallery.includes(p.trim())&&(U(s=>({...s,imageGallery:[...s.imageGallery,p.trim()]})),F(""))},ve=s=>{U(n=>({...n,imageGallery:n.imageGallery.filter(N=>N!==s)}))},Ae=()=>{_.trim()&&!i.blueprints.includes(_.trim())&&(U(s=>({...s,blueprints:[...s.blueprints,_.trim()]})),$(""))},$e=s=>{U(n=>({...n,blueprints:n.blueprints.filter(N=>N!==s)}))},Re=()=>{if(m.trim()&&Y.trim()){const s={url:m.trim(),type:"external",thumbnail:Y.trim()};U(n=>({...n,videos:[...n.videos,s]})),L(""),c("")}},Ve=s=>{U(n=>({...n,videos:n.videos.filter((N,M)=>M!==s)}))},fe=(s,n)=>(n==="image"?s.type.startsWith("image/"):s.type.startsWith("video/"))?!0:(alert(`Please select a valid ${n} file. Any ${n} type is supported.`),!1),be=async(s,n,N)=>{const{data:{user:M}}=await g.auth.getUser();if(!M)throw new Error("You must be logged in to upload files");const H=s.name.split(".").pop(),te=`${Date.now()}-${Math.random().toString(36).substring(2)}.${H}`;let G="images";n==="video"&&(G="videos"),n==="thumbnail"&&(G="thumbnails"),n==="blueprint"&&(G="blueprints");const X=`projects/${N}/${G}/${te}`,{error:ge}=await g.storage.from("portfolio").upload(X,s,{cacheControl:"3600",upsert:!1});if(ge)throw ge;const{data:ie}=g.storage.from("portfolio").getPublicUrl(X);return ie.publicUrl},qe=async s=>{if(!s||s.length===0||!b)return;se(!0);const n=Array.from(s);for(const N of n)if(fe(N,"image"))try{const M=await be(N,"image",b.id);U(H=>({...H,imageGallery:[...H.imageGallery,M]}))}catch(M){const H=M instanceof Error?M.message:"Unknown error";alert(`Failed to upload ${N.name}: ${H}`)}se(!1)},Ge=async s=>{if(!s||s.length===0||!b)return;ae(!0);const n=Array.from(s);for(const N of n)if(fe(N,"video"))try{const M=await be(N,"video",b.id),H=M.replace(/\.(mp4|webm|avi|mov|wmv)$/i,".jpg"),te={url:M,type:"local",thumbnail:H};U(G=>({...G,videos:[...G.videos,te]}))}catch(M){const H=M instanceof Error?M.message:"Unknown error";alert(`Failed to upload ${N.name}: ${H}`)}ae(!1)},Be=async s=>{if(!(!s||!b)&&fe(s,"image"))try{me(!0);const n=await be(s,"thumbnail",b.id);U(N=>({...N,image:n}))}catch(n){const N=n instanceof Error?n.message:"Unknown error";alert(`Failed to upload main image: ${N}`)}finally{me(!1)}},Oe=async s=>{if(s.preventDefault(),!i.title||!i.description||!i.image||!i.location){alert("Please fill in all required fields");return}if(b){W(!0);try{const n={...i.specifications};i.height&&(n.height=i.height),i.floors&&(n.floors=i.floors),i.area&&(n.area=i.area),i.completion&&(n.completion=i.completion),i.units&&(n.units=i.units),i.bedrooms&&(n.bedrooms=i.bedrooms),i.length&&(n.length=i.length),i.lanes&&(n.lanes=i.lanes);const N={specifications:Object.keys(n).length>0?n:void 0,timeline:i.timeline||void 0,materials:i.materials.length>0?i.materials:void 0,features:i.features.length>0?i.features:void 0,imageGallery:i.imageGallery.length>0?i.imageGallery:void 0,blueprints:i.blueprints.length>0?i.blueprints:void 0,videos:i.videos.length>0?i.videos:void 0,virtualTour:i.virtualTour||void 0},{error:M}=await g.from("projects").update({title:i.title,description:i.description,status:i.status,image:i.image,location:i.location,category:i.category||null,details:N}).eq("id",b.id);if(M)throw M;alert("Project updated successfully!"),l(),t()}catch(n){const N=n instanceof Error?n.message:"Unknown error";alert("Failed to update project: "+N)}finally{W(!1)}}},Ne=a.filter(s=>s.title?.toLowerCase().includes(h.toLowerCase())||s.location?.toLowerCase().includes(h.toLowerCase())||s.description?.toLowerCase().includes(h.toLowerCase()));return T?e.jsxs("div",{className:"content-section",children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading projects..."})]}):e.jsxs("div",{className:"content-section",children:[e.jsxs("div",{className:"section-header",children:[e.jsx("h1",{children:"Manage Projects"}),e.jsx("p",{children:"View, edit, and delete projects"})]}),e.jsxs("div",{className:"management-controls",children:[e.jsxs("div",{className:"search-container",children:[e.jsx("button",{className:"search-toggle-btn",onClick:()=>P(!I),"aria-label":"Toggle search",children:e.jsx(de,{size:20})}),e.jsx("input",{type:"text",placeholder:"Search projects by title, location, or description...",value:h,onChange:s=>w(s.target.value),className:`search-input ${I?"expanded":""}`}),h&&e.jsx("button",{className:"clear-search-btn",onClick:()=>w(""),"aria-label":"Clear search",children:e.jsx(A,{size:16})})]}),e.jsxs("div",{className:"stats-summary",children:[e.jsxs("span",{children:["Total Projects: ",a.length]}),e.jsxs("span",{children:["Ongoing: ",a.filter(s=>s.status==="ongoing").length]}),e.jsxs("span",{children:["Completed: ",a.filter(s=>s.status==="completed").length]})]})]}),e.jsx("div",{className:"data-table-container desktop-table",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Image"}),e.jsx("th",{children:"Title"}),e.jsx("th",{children:"Category"}),e.jsx("th",{children:"Location"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Date"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:Ne.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:s.image,alt:s.title,className:"project-thumbnail",onError:n=>{n.target.src="https://via.placeholder.com/100?text=No+Image"}})}),e.jsx("td",{children:s.title}),e.jsx("td",{children:s.category||"N/A"}),e.jsx("td",{children:s.location}),e.jsx("td",{children:e.jsx("span",{className:`status-badge ${s.status==="completed"?"completed":"ongoing"}`,children:s.status})}),e.jsx("td",{children:new Date(s.created_at).toLocaleDateString()}),e.jsxs("td",{children:[e.jsxs("button",{className:"action-btn edit",onClick:()=>ue(s),children:[e.jsx(Ce,{size:16}),"Edit"]}),e.jsxs("button",{className:"action-btn delete",onClick:()=>j(s.id),children:[e.jsx(Se,{size:16}),"Delete"]})]})]},s.id))})]})}),e.jsx("div",{className:"mobile-cards-view",children:Ne.map(s=>e.jsxs("div",{className:"project-card-admin",children:[e.jsx("img",{src:s.image,alt:s.title,className:"project-card-image",onError:n=>{n.target.src="https://via.placeholder.com/300?text=No+Image"}}),e.jsxs("div",{className:"project-card-content",children:[e.jsx("h3",{children:s.title}),e.jsxs("p",{className:"project-card-location",children:["ðŸ“ ",s.location]}),e.jsxs("div",{className:"project-card-meta",children:[e.jsx("span",{className:"project-card-category",children:s.category||"N/A"}),e.jsx("span",{className:`status-badge ${s.status==="completed"?"completed":"ongoing"}`,children:s.status})]}),e.jsxs("div",{className:"project-card-actions",children:[e.jsxs("button",{className:"action-btn edit",onClick:()=>ue(s),children:[e.jsx(Ce,{size:16}),"Edit"]}),e.jsxs("button",{className:"action-btn delete",onClick:()=>j(s.id),children:[e.jsx(Se,{size:16}),"Delete"]})]})]})]},s.id))}),Ne.length===0&&e.jsx("div",{className:"empty-state",children:e.jsx("p",{children:"No projects found"})}),E&&b&&e.jsx("div",{className:"modal-overlay",onClick:l,children:e.jsxs("div",{className:"modal-content large-modal",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h2",{children:"Edit Project"}),e.jsx("button",{className:"modal-close",onClick:l,children:e.jsx(A,{size:24})})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:Oe,className:"project-form",children:[e.jsxs("div",{className:"form-group edit-project-title-group",children:[e.jsxs("label",{htmlFor:"edit-title",className:"edit-project-title-label",children:[e.jsx(ye,{size:20,className:"edit-title-icon"}),"Project Title *"]}),e.jsx("input",{type:"text",id:"edit-title",name:"title",value:i.title,onChange:o,required:!0,placeholder:"e.g., The Metropol",className:"form-input edit-project-title-input"})]}),e.jsxs("div",{className:"form-group edit-description-group",children:[e.jsxs("label",{htmlFor:"edit-description",className:"edit-description-label",children:[e.jsx(Z,{size:20,className:"edit-description-icon"}),"Description *"]}),e.jsx("textarea",{id:"edit-description",name:"description",value:i.description,onChange:o,required:!0,rows:4,placeholder:"Project description...",className:"form-textarea edit-description-textarea"})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group edit-status-group",children:[e.jsxs("label",{htmlFor:"edit-status",className:"edit-status-label",children:[e.jsx(Ee,{size:20,className:"edit-status-icon"}),"Status *"]}),e.jsxs("select",{id:"edit-status",name:"status",value:i.status,onChange:o,required:!0,className:"form-input edit-status-select",children:[e.jsx("option",{value:"ongoing",children:"Ongoing"}),e.jsx("option",{value:"completed",children:"Completed"})]})]}),e.jsxs("div",{className:"form-group edit-category-group",children:[e.jsxs("label",{htmlFor:"edit-category",className:"edit-category-label",children:[e.jsx(je,{size:20,className:"edit-category-icon"}),"Category"]}),e.jsxs("select",{id:"edit-category",name:"category",value:i.category,onChange:o,className:"form-input edit-category-select",children:[e.jsx("option",{value:"",children:"Select Category"}),e.jsx("option",{value:"residential",children:"Residential"}),e.jsx("option",{value:"commercial",children:"Commercial"}),e.jsx("option",{value:"town-houses",children:"Town Houses"}),e.jsx("option",{value:"group-dualling",children:"Group Dualling"}),e.jsx("option",{value:"architectural",children:"Architectural"})]})]})]}),e.jsxs("div",{className:"form-group edit-image-group",children:[e.jsxs("label",{htmlFor:"edit-image",className:"edit-image-label",children:[e.jsx(le,{size:20,className:"edit-image-icon"}),"Main Image (Thumbnail) *"]}),e.jsx("div",{className:"input-with-button",style:{marginBottom:"10px"},children:e.jsx("input",{type:"url",id:"edit-image",name:"image",value:i.image,onChange:o,required:!0,placeholder:"Image URL or upload file below"})}),e.jsxs("div",{className:"upload-group",children:[e.jsx("label",{className:"upload-label",style:{display:"block",marginBottom:"8px"},children:"Upload Main Image"}),e.jsx("input",{type:"file",accept:"image/*",onChange:s=>{const n=s.target.files?.[0]||null;Be(n),s.target.value=""},style:{display:"none"},id:"edit-main-image-upload"}),e.jsxs("label",{htmlFor:"edit-main-image-upload",className:"upload-btn",children:[e.jsx(O,{size:16}),"Select Main Image"]}),oe&&e.jsx("span",{style:{marginLeft:"10px"},children:"Uploading..."})]}),i.image&&e.jsx("div",{style:{marginTop:"10px"},children:e.jsx("img",{src:i.image,alt:"Main image preview",style:{maxWidth:"200px",maxHeight:"200px",objectFit:"cover",borderRadius:"4px"}})}),e.jsx("p",{style:{fontSize:"0.85rem",color:"#666",marginTop:"5px"},children:"Upload a main thumbnail image or provide a URL. This image will be displayed on the Projects page."})]}),e.jsxs("div",{className:"form-group edit-location-group",children:[e.jsxs("label",{htmlFor:"edit-location",className:"edit-location-label",children:[e.jsx(ze,{size:20,className:"edit-location-icon"}),"Location *"]}),e.jsx("input",{type:"text",id:"edit-location",name:"location",value:i.location,onChange:o,required:!0,placeholder:"e.g., Accra, Ghana",className:"form-input edit-location-input"})]}),e.jsxs("div",{className:"form-group edit-timeline-group",children:[e.jsxs("label",{htmlFor:"edit-timeline",className:"edit-timeline-label",children:[e.jsx(Te,{size:20,className:"edit-timeline-icon"}),"Timeline"]}),e.jsx("input",{type:"text",id:"edit-timeline",name:"timeline",value:i.timeline,onChange:o,placeholder:"e.g., 2018-2025",className:"form-input edit-timeline-input"})]}),e.jsxs("div",{className:"form-group edit-virtual-tour-group",children:[e.jsxs("label",{htmlFor:"edit-virtualTour",className:"edit-virtual-tour-label",children:[e.jsx(Ie,{size:20,className:"edit-virtual-tour-icon"}),"Virtual Tour URL"]}),e.jsx("input",{type:"url",id:"edit-virtualTour",name:"virtualTour",value:i.virtualTour,onChange:o,placeholder:"https://...",className:"form-input edit-virtual-tour-input"})]}),e.jsxs("div",{className:"form-group edit-specifications-group",children:[e.jsxs("label",{className:"edit-specifications-label",children:[e.jsx(Le,{size:20,className:"edit-specifications-icon"}),"Specifications"]}),e.jsxs("div",{className:"common-specs-grid",children:[e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-height",children:"Height"}),e.jsx("input",{type:"text",id:"edit-height",name:"height",value:i.height,onChange:o,placeholder:"e.g., 300m"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-floors",children:"Floors"}),e.jsx("input",{type:"text",id:"edit-floors",name:"floors",value:i.floors,onChange:o,placeholder:"e.g., 80"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-area",children:"Area"}),e.jsx("input",{type:"text",id:"edit-area",name:"area",value:i.area,onChange:o,placeholder:"e.g., 150,000 sq ft"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-completion",children:"Completion"}),e.jsx("input",{type:"text",id:"edit-completion",name:"completion",value:i.completion,onChange:o,placeholder:"e.g., 2022"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-units",children:"Units"}),e.jsx("input",{type:"text",id:"edit-units",name:"units",value:i.units,onChange:o,placeholder:"e.g., 120"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-bedrooms",children:"Bedrooms"}),e.jsx("input",{type:"text",id:"edit-bedrooms",name:"bedrooms",value:i.bedrooms,onChange:o,placeholder:"e.g., 8"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-length",children:"Length"}),e.jsx("input",{type:"text",id:"edit-length",name:"length",value:i.length,onChange:o,placeholder:"e.g., 2.5km"})]}),e.jsxs("div",{className:"spec-field",children:[e.jsx("label",{htmlFor:"edit-lanes",children:"Lanes"}),e.jsx("input",{type:"text",id:"edit-lanes",name:"lanes",value:i.lanes,onChange:o,placeholder:"e.g., 6"})]})]}),e.jsxs("div",{className:"dynamic-specs-section",children:[e.jsx("h4",{children:"Additional Specifications"}),e.jsxs("div",{className:"spec-input-group",children:[e.jsx("input",{type:"text",placeholder:"Key (e.g., parking spaces)",value:D,onChange:s=>V(s.target.value)}),e.jsx("input",{type:"text",placeholder:"Value (e.g., 500)",value:B,onChange:s=>u(s.target.value)}),e.jsxs("button",{type:"button",onClick:S,className:"add-btn",children:[e.jsx(K,{size:16})," Add"]})]}),e.jsx("div",{className:"tags-list",children:Object.entries(i.specifications).map(([s,n])=>e.jsxs("span",{className:"tag",children:[s,": ",n,e.jsx("button",{type:"button",onClick:()=>q(s),className:"tag-remove",children:e.jsx(A,{size:12})})]},s))})]})]}),e.jsxs("div",{className:"form-group edit-materials-group",children:[e.jsxs("label",{className:"edit-materials-label",children:[e.jsx(Me,{size:20,className:"edit-materials-icon"}),"Materials"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"text",placeholder:"Add material",value:f,onChange:s=>k(s.target.value),onKeyDown:s=>s.key==="Enter"&&(s.preventDefault(),J()),className:"edit-material-input"}),e.jsx("button",{type:"button",onClick:J,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsx("div",{className:"tags-list",children:i.materials.map((s,n)=>e.jsxs("span",{className:"tag",children:[s,e.jsx("button",{type:"button",onClick:()=>ce(s),className:"tag-remove",children:e.jsx(A,{size:12})})]},n))})]}),e.jsxs("div",{className:"form-group edit-features-group",children:[e.jsxs("label",{className:"edit-features-label",children:[e.jsx(De,{size:20,className:"edit-features-icon"}),"Features"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"text",placeholder:"Add feature",value:d,onChange:s=>v(s.target.value),onKeyDown:s=>s.key==="Enter"&&(s.preventDefault(),Q()),className:"edit-feature-input"}),e.jsx("button",{type:"button",onClick:Q,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsx("div",{className:"tags-list",children:i.features.map((s,n)=>e.jsxs("span",{className:"tag",children:[s,e.jsx("button",{type:"button",onClick:()=>he(s),className:"tag-remove",children:e.jsx(A,{size:12})})]},n))})]}),e.jsxs("div",{className:"form-group edit-image-gallery-group",children:[e.jsxs("label",{className:"edit-image-gallery-label",children:[e.jsx(_e,{size:20,className:"edit-image-gallery-icon"}),"Image Gallery (Unlimited Images)"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"url",placeholder:"Image URL (or upload files below)",value:p,onChange:s=>F(s.target.value)}),e.jsx("button",{type:"button",onClick:pe,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsxs("div",{className:"upload-group",style:{marginTop:"10px"},children:[e.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:s=>qe(s.target.files),style:{display:"none"},id:"edit-image-file-upload"}),e.jsxs("label",{htmlFor:"edit-image-file-upload",className:"upload-btn",children:[e.jsx(O,{size:16}),"Select Images (Multiple)"]}),ee&&e.jsx("span",{style:{marginLeft:"10px"},children:"Uploading..."})]}),e.jsx("div",{className:"tags-list",style:{marginTop:"10px"},children:i.imageGallery.map((s,n)=>e.jsxs("span",{className:"tag",children:[e.jsx(le,{size:12})," Image ",n+1,e.jsx("button",{type:"button",onClick:()=>ve(s),className:"tag-remove",children:e.jsx(A,{size:12})})]},n))})]}),e.jsxs("div",{className:"form-group edit-videos-group",children:[e.jsxs("label",{className:"edit-videos-label",children:[e.jsx(ne,{size:20,className:"edit-videos-icon"}),"Videos (Unlimited Videos)"]}),e.jsxs("div",{className:"video-input-group",children:[e.jsx("input",{type:"url",placeholder:"Video URL (YouTube, Vimeo, etc.)",value:m,onChange:s=>L(s.target.value),className:"edit-video-url-input"}),e.jsx("input",{type:"url",placeholder:"Thumbnail URL",value:Y,onChange:s=>c(s.target.value),className:"edit-video-thumbnail-input"}),e.jsx("button",{type:"button",onClick:Re,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsxs("div",{className:"upload-group",style:{marginTop:"10px"},children:[e.jsx("label",{className:"upload-label",style:{display:"block",marginBottom:"8px"},children:"Upload Videos (Multiple files supported - Unlimited)"}),e.jsx("input",{type:"file",accept:"video/*",multiple:!0,onChange:s=>Ge(s.target.files),style:{display:"none"},id:"edit-video-file-upload"}),e.jsxs("label",{htmlFor:"edit-video-file-upload",className:"upload-btn",children:[e.jsx(O,{size:16}),"Select Videos (Multiple)"]}),re&&e.jsx("span",{style:{marginLeft:"10px"},children:"Uploading..."})]}),e.jsx("div",{className:"tags-list",style:{marginTop:"10px"},children:i.videos.map((s,n)=>e.jsxs("span",{className:"tag",children:[e.jsx(ne,{size:12})," ",s.type," Video",e.jsx("button",{type:"button",onClick:()=>Ve(n),className:"tag-remove",children:e.jsx(A,{size:12})})]},n))}),e.jsx("p",{style:{fontSize:"0.85rem",color:"#666",marginTop:"5px"},children:"You can upload unlimited videos. Files will be stored in Supabase Storage. Max 50MB per video."})]}),e.jsxs("div",{className:"form-group edit-blueprints-group",children:[e.jsxs("label",{className:"edit-blueprints-label",children:[e.jsx(Pe,{size:20,className:"edit-blueprints-icon"}),"Blueprints"]}),e.jsxs("div",{className:"input-with-button",children:[e.jsx("input",{type:"url",placeholder:"Blueprint URL",value:_,onChange:s=>$(s.target.value),className:"edit-blueprint-url-input"}),e.jsx("button",{type:"button",onClick:Ae,className:"add-btn",children:e.jsx(K,{size:16})})]}),e.jsx("div",{className:"tags-list",children:i.blueprints.map((s,n)=>e.jsxs("span",{className:"tag",children:["Blueprint ",n+1,e.jsx("button",{type:"button",onClick:()=>$e(s),className:"tag-remove",children:e.jsx(A,{size:12})})]},n))})]}),e.jsxs("div",{className:"modal-actions",children:[e.jsx("button",{type:"button",onClick:l,className:"cancel-btn",children:"Cancel"}),e.jsx("button",{type:"submit",className:"submit-btn",disabled:R,children:R?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"loading-spinner small"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(O,{size:16}),"Update Project"]})})]})]})})]})})]})};export{gs as default};
